<?xml version="1.0" encoding="UTF-8" standalone="no"?><map version="0.8.1"><node CREATED="1426313269112" ID="6i94sjfd809olb0251o0olno39" MODIFIED="1426313269112" TEXT="14.应对恶意脚本"><node CREATED="1426313269112" ID="6c50p75pf7lv621d419irsjmki" MODIFIED="1426313269112" POSITION="right" TEXT="拒绝服务攻击"><node CREATED="1426313269112" ID="7i4eqbfect64not2pu5fdhr17d" MODIFIED="1426313269112" TEXT="概述"><node CREATED="1426313269113" ID="2kvdjbtapn373mgucrsspf4d82" MODIFIED="1426313269113" TEXT="没有考虑过合理限制CPU/内存的占用"/><node CREATED="1426313269113" ID="252v5fbdiitd3cl3d81737iojd" MODIFIED="1426313269113" TEXT="常见伎俩"><node CREATED="1426313269113" ID="3tme9nr3sdhhh10fs9jfhdf0rg" MODIFIED="1426313269113" TEXT="加载复杂的XHTML/SVG文件"/><node CREATED="1426313269113" ID="617aikg0hsbggllv2igc3obfbl" MODIFIED="1426313269113" TEXT="反复弹出大量浏览器窗口"/><node CREATED="1426313269113" ID="0pqgv73f2hv6inlcanghlq8mq8" MODIFIED="1426313269113" TEXT="允许需要分配内存的JS死循环程序"/><node CREATED="1426313269113" ID="24t3bp2ee79u94gfaspnuoiicg" MODIFIED="1426313269114" TEXT="制造大量的postMessage(...)调用队列"/></node></node><node CREATED="1426313269114" ID="43mvllmak724a1d0ssilpcp3el" MODIFIED="1426313269114" TEXT="措施"><node CREATED="1426313269114" ID="37b3i5ru0rluld76rkff3j3vug" MODIFIED="1426313269114" TEXT="执行时间和内存使用的限制"><node CREATED="1426313269114" ID="46oc5ac2jjja310p0kanc5e814" MODIFIED="1426313269114" TEXT="执行时间限制"><node CREATED="1426313269116" ID="010crji95vfva0f8kt5ndugv5i" MODIFIED="1426313269117" TEXT="绕过方法"><node CREATED="1426313269117" ID="5assgejftjjm4is8um3k2gfl1g" MODIFIED="1426313269117" TEXT="恶意脚本使用定时器事件或事件处理程序再次执行"/><node CREATED="1426313269117" ID="19lv5bvv9cvuq5cfk5s2sreo42" MODIFIED="1426313269117" TEXT="间歇性暂时释放CPU"/><node CREATED="1426313269117" ID="3djmt0bktmn1q0h9kfe2snr3db" MODIFIED="1426313269117" TEXT="渲染复杂的XHTML、SVG、XSLT文件"/></node></node><node CREATED="1426313269118" ID="6qnfe9ip74ictgl7uvq9gb5v5q" MODIFIED="1426313269118" TEXT="内存占用限制"><node CREATED="1426313269118" ID="2ps8n4ng5inv2435qfg68t4lpa" MODIFIED="1426313269118" TEXT="做法"><node CREATED="1426313269118" ID="029gaslk982qdo353una6kvt7r" MODIFIED="1426313269118" TEXT="调用栈的大小和浏览器有关"/><node CREATED="1426313269118" ID="7hublf2u9s2ngbeh25tvlsv0oa" MODIFIED="1426313269119" TEXT="深度递归无条件终止"/><node CREATED="1426313269120" ID="7o81t5ibm998rmn6vo0438001o" MODIFIED="1426313269125" TEXT="脚本堆大小基本没限制"/></node></node></node><node CREATED="1426313269126" ID="4ebi50phjhqf6i76sm9bjreit5" MODIFIED="1426313269126" TEXT="连接限制"><node CREATED="1426313269126" ID="377f934o96dlqetll79rhm650k" MODIFIED="1426313269126" TEXT="同一时间HTTP会话数量有限制，但有效的会话保持时间没限制"/></node><node CREATED="1426313269126" ID="7a051oe4fmd4biug32cdi534qe" MODIFIED="1426313269126" TEXT="过滤弹出窗口"><node CREATED="1426313269127" ID="5qjmac7t461b0l40kna2mnin8h" MODIFIED="1426313269127" TEXT="方法"><node CREATED="1426313269127" ID="5aub1i5c7s2qk05deisk9r5f1e" MODIFIED="1426313269127" TEXT="window.open(...)"/><node CREATED="1426313269127" ID="34on0cv3ranqeq278ttcmeks22" MODIFIED="1426313269127" TEXT="window.showModalDialog(...)"/><node CREATED="1426313269127" ID="4gh9i12jahqcfpo9618i4bmfaf" MODIFIED="1426313269127" TEXT="用某些HTML元素的编程接口创建新窗口"/></node><node CREATED="1426313269127" ID="4cibvdc9behje74eu4ns7pksm4" MODIFIED="1426313269127" TEXT="类型"><node CREATED="1426313269127" ID="7jjn48jud0hbq4f0o5i5noj9ap" MODIFIED="1426313269127" TEXT="弹出式窗口"/><node CREATED="1426313269127" ID="55sn6f39mlpo2509iajl10a8ea" MODIFIED="1426313269127" TEXT="隐形弹出窗口"/></node><node CREATED="1426313269127" ID="2n7c7jj7gv77bp21es2aum5js5" MODIFIED="1426313269127" TEXT="浏览器干预"><node CREATED="1426313269127" ID="2ah2beftbh15sar24o7gtrpujg" MODIFIED="1426313269127" TEXT="如果不在白名单的页面要偷偷弹窗口，浏览器会默默忽略"/><node CREATED="1426313269127" ID="0id7s4mrb3tl3se63deej5nua8" MODIFIED="1426313269127" TEXT="绕过"><node CREATED="1426313269127" ID="61h6qkuar8b45poqtg4sb6omdc" MODIFIED="1426313269127" TEXT="点击后弹出"/><node CREATED="1426313269127" ID="3f2sjoj8vkes8tvb0c20dkjhjl" MODIFIED="1426313269127" TEXT="全屏广告"/></node></node><node CREATED="1426313269127" ID="14c0bl8ddg0ptghmqqfiropt84" MODIFIED="1426313269127" TEXT="DoS"><node CREATED="1426313269127" ID="5tm7aj47c5k43gsju2eh90dgts" MODIFIED="1426313269127" TEXT="耗尽操作系统允许的最大UI句柄数量"/><node CREATED="1426313269127" ID="4rmtpnsir0rv6fqvd5mnsuh47p" MODIFIED="1426313269127" TEXT="只有IE和Chrome会限制单次点击可以弹出的window.open(...)数量"/></node></node><node CREATED="1426313269127" ID="42pr62c1da0ecqdqhh3vlg3hs6" MODIFIED="1426313269127" TEXT="对话框的使用限制"><node CREATED="1426313269127" ID="0s3eoh7mftq1376d7h6rh9clkj" MODIFIED="1426313269127" TEXT="方法"><node CREATED="1426313269127" ID="1djbq3ja3llrn6jbidf76vgdh3" MODIFIED="1426313269127" TEXT="JS"><node CREATED="1426313269127" ID="5ie7hokm8mp1tm1787he5icbhm" MODIFIED="1426313269127" TEXT="window.alert(...)"/><node CREATED="1426313269127" ID="4469snbd8g39lm18i7aad3ui8l" MODIFIED="1426313269127" TEXT="window.prompt(...)和window.confirm(...)"/><node CREATED="1426313269128" ID="50518bjpk79en877tbf93rqphf" MODIFIED="1426313269128" TEXT="window.print(...)"/><node CREATED="1426313269128" ID="6c6ioe0rnpvleo20a2ghaq4jou" MODIFIED="1426313269128" TEXT="Mozilla的window.sidebar.addPanel(...)、window.sidebar.addSearchEngine(...)等"/></node><node CREATED="1426313269128" ID="2k1o7p9r891n9n192g6dfbbh0d" MODIFIED="1426313269128" TEXT="间接派生"><node CREATED="1426313269128" ID="30n2n2d0b2ehpht3kdtn9jtbks" MODIFIED="1426313269128" TEXT="调用上传按钮的click方法"/><node CREATED="1426313269128" ID="2husl4bd1tk2f1oc3cspvudt6u" MODIFIED="1426313269128" TEXT="访问一个可下载的文件"/><node CREATED="1426313269128" ID="41e9cn24lu23qdofmr36ndnffj" MODIFIED="1426313269128" TEXT="需要HTTP认证"/><node CREATED="1426313269128" ID="2c1tf7gm5v30ofvl045oi10c7u" MODIFIED="1426313269128" TEXT="……"/></node></node><node CREATED="1426313269128" ID="3pmvrdif096nbnlkugp9c41ep7" MODIFIED="1426313269128" TEXT="特点"><node CREATED="1426313269128" ID="4ecg07f1j3fki26hc3vcjid7mu" MODIFIED="1426313269128" TEXT="对话框会终止JS和其他动作的执行"/><node CREATED="1426313269128" ID="2bcgp37k30eku123k1f8susf6f" MODIFIED="1426313269128" TEXT="除非关掉对话框，否则无法和浏览器的其他部分交互"/></node><node CREATED="1426313269128" ID="6gm0tgt961j6nbetocbouv25f0" MODIFIED="1426313269128" TEXT="利用"><node CREATED="1426313269128" ID="10engces025mikp1jift9dtg0j" MODIFIED="1426313269128" TEXT="关掉旧对话框后弹出新对话框"/></node><node CREATED="1426313269128" ID="6l14l94jgsgue2b3lu55i146q2" MODIFIED="1426313269128" TEXT="浏览器"><node CREATED="1426313269128" ID="2i10k048vlesgcqha6apvaaemg" MODIFIED="1426313269128" TEXT="Chrome：复选框允许用户不再显示该网站的对话框"/><node CREATED="1426313269128" ID="3a6h00ifiivbpb8l0q5bdsv303" MODIFIED="1426313269128" TEXT="Oepra：可停止执行本页面的脚本"/><node CREATED="1426313269128" ID="551lga6crfq3i3k19dr6hvojva" MODIFIED="1426313269128" TEXT="Opera、Firefox：只有在文档显示相关的区域范围内，对话框才是模态的"/></node></node></node></node><node CREATED="1426313269128" ID="6hbbc6e8o3a9erl3hqu1f10lej" MODIFIED="1426313269128" POSITION="right" TEXT="窗口定位和外观问题"><node CREATED="1426313269128" ID="5v15enp6g571rshbd4kga1delm" MODIFIED="1426313269128" TEXT="利用"><node CREATED="1426313269128" ID="19faj2un0a6tgrtgekdjshkkbn" MODIFIED="1426313269128" TEXT="把窗口移到屏幕外或缩到非常小"><node CREATED="1426313269128" ID="0f9efu7o1djo5b91fqo1li0kh7" MODIFIED="1426313269128" TEXT="解决"><node CREATED="1426313269128" ID="1s9ubc7rda6o7a1hsh9t893lpm" MODIFIED="1426313269128" TEXT="要求新建的窗口至少有一定的面积，且显示在可视区域内"/></node></node><node CREATED="1426313269128" ID="4j13r8upe6gioi6e40qv7g7s59" MODIFIED="1426313269128" TEXT="刻意缩小的窗口对主机名进行裁剪"/><node CREATED="1426313269128" ID="6iaug5cerdvadonmv8i3n4k2sc" MODIFIED="1426313269128" TEXT="窗口分割攻击"><node CREATED="1426313269128" ID="46njppp5r4hklbhgf8e8ujmnup" MODIFIED="1426313269128" TEXT="准确对齐和重叠多个窗口，使其像一个窗口"/></node><node CREATED="1426313269128" ID="0u7cg86l3jcpd4k3iq0doejdff" MODIFIED="1426313269128" TEXT="location=no隐藏地址栏"><node CREATED="1426313269128" ID="5d12h7a6vs278t0vc79h731gcc" MODIFIED="1426313269128" TEXT="解决"><node CREATED="1426313269128" ID="1t7dq5mrqlltc397fd942lsk94" MODIFIED="1426313269128" TEXT="除Safari外，显示只读的地址栏"/></node></node></node></node><node CREATED="1426313269128" ID="1p7957135s4rijued26utcj91a" MODIFIED="1426313269128" POSITION="right" TEXT="用户界面的时差攻击"><node CREATED="1426313269128" ID="4t9k57crv00e38a8jsd09skjrg" MODIFIED="1426313269128" TEXT="由于人类自身认知的局限性，难以解决"/><node CREATED="1426313269128" ID="57enkoj14vhfovdp1m17bbr3be" MODIFIED="1426313269128" TEXT="举例"/><node CREATED="1426313269128" ID="35l2uj6jto7n0imqufvuevd2is" MODIFIED="1426313269128" TEXT="隐形的大猩猩实验"/></node><node CREATED="1426313269128" ID="6ant84im9fv5ttcvnbcu72j2o5" MODIFIED="1426313269129" POSITION="left" TEXT="安全工程速查表"><node CREATED="1426313269129" ID="1e74b627itjj53rlv4rc5iokqi" MODIFIED="1426313269129" TEXT="当允许用户创建的&lt;iframe&gt;页面组件出现在网站上时"><node CREATED="1426313269129" ID="2km8oojnkq8i4bbc7gv04ovp57" MODIFIED="1426313269129" TEXT="尽量不要这么做"/></node><node CREATED="1426313269129" ID="6i9fbj4upgkp8i1oop47hpskd3" MODIFIED="1426313269129" TEXT="当创建安全要求高的UI时"><node CREATED="1426313269129" ID="5cd54akaltubq1bsfk7j5e2cq5" MODIFIED="1426313269129" TEXT="尽量避免一个简单的按键或点击就能修改某个关键性设置的情况"/></node></node></node></map>