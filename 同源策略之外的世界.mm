<?xml version="1.0" encoding="UTF-8" standalone="no"?><map version="0.8.1"><node CREATED="1426313300522" ID="3vkfvm8mm6kbkvo45fo386jvi1" MODIFIED="1426313300522" TEXT="11.同源策略之外的世界"><node CREATED="1426313300522" ID="09sdljpgehcub06k09m811qf6l" MODIFIED="1426313300522" POSITION="right" TEXT="窗口和框架的交互"><node CREATED="1426313300522" ID="4ookskaj9gn4tfmruj9bk144ci" MODIFIED="1426313300522" TEXT="改变现有页面的地址"><node CREATED="1426313300522" ID="4s1upe8b2uivucash14sdqeosh" MODIFIED="1426313300522" TEXT="把无关页面指向新地址"><node CREATED="1426313300522" ID="2kmu0db01irnq1rhqqoii9fc7v" MODIFIED="1426313300522" TEXT="name定位"/><node CREATED="1426313300522" ID="6qebiuud7iq20sgcbbqg8v8ca5" MODIFIED="1426313300522" TEXT="JS通过激活某些DOM方法打开窗口"><node CREATED="1426313300522" ID="6jnmi84e61tv795sogj0o5po0u" MODIFIED="1426313300522" TEXT="遍历opener、top、parent、frames[]"/></node></node><node CREATED="1426313300528" ID="71l3cbt5q60qnhvleqkh38i5fk" MODIFIED="1426313300528" TEXT="框架劫持的风险"><node CREATED="1426313300528" ID="3cr4c0f7rtdccc7c7n7apm045t" MODIFIED="1426313300528" TEXT="钓鱼"/><node CREATED="1426313300528" ID="1kvargd9mtkcompps87dmbpk6k" MODIFIED="1426313300528" TEXT="无关站点可以劫持子框架，而在地址栏不露痕迹"><node CREATED="1426313300531" ID="7shv62foan6fpn2564sgtbr4i2" MODIFIED="1426313300531" TEXT="限制所有跨框架跳转在同一窗口进行"/></node></node><node CREATED="1426313300531" ID="362tcrh2tb0lctn8e0pao7j5q0" MODIFIED="1426313300531" TEXT="框架继承策略和跨域通信"><node CREATED="1426313300531" ID="0n1s0fo93qahl36ghg5k3v6dri" MODIFIED="1426313300531" TEXT="问题"><node CREATED="1426313300531" ID="2odb8iubifd8qthipn81dotulr" MODIFIED="1426313300531" TEXT="mashups"><node CREATED="1426313300531" ID="7l80g0c9te7ocnbhkldqvlmni3" MODIFIED="1426313300531" TEXT="组合了不同源的数据"/></node></node><node CREATED="1426313300531" ID="1et2tu2f87lh858hn64jpkapti" MODIFIED="1426313300531" TEXT="解决"><node CREATED="1426313300531" ID="4uiqfps7fcnm7comh1ii56ofkc" MODIFIED="1426313300531" TEXT="微软的框架跳转继承策略"><node CREATED="1426313300531" ID="1abf67tboa3r7mlrbcf02btm86" MODIFIED="1426313300531" TEXT="只有发起跳转的一方与目标视图的某个上级页面同源时，才可以非同源的跳转"/><node CREATED="1426313300531" ID="0e633sogmf7rv5lj20903kbif8" MODIFIED="1426313300531" TEXT="陷阱"><node CREATED="1426313300531" ID="69n6fei4surujk1fvtbtikg13d" MODIFIED="1426313300531" TEXT="某些Web应用使用框架作为非同源情况下传递程序信息的方式"><node CREATED="1426313300531" ID="6anf5d444us1h871gf7n7vvbou" MODIFIED="1426313300531" TEXT="不能使用postMessage(...)的情况常见"/><node CREATED="1426313300531" ID="3j9t076v10ldvan47r6eub0ucj" MODIFIED="1426313300531" TEXT="即使用了postMessage，也可能劫持"><node CREATED="1426313300531" ID="0rus1lm35g6g8m1qru8boqh4ik" MODIFIED="1426313300531" TEXT="发送方没有指定接收方的源"/><node CREATED="1426313300531" ID="2rm2h1n8gb70hu87i9g6desgh1" MODIFIED="1426313300531" TEXT="接收方不检查发起方的源"/></node></node></node></node></node></node></node><node CREATED="1426313300531" ID="4irh848lfs9ulk034n62l5b06g" MODIFIED="1426313300531" TEXT="不请自来的框架"><node CREATED="1426313300531" ID="4u0senrjc9nv76ba2r0sp1r41d" MODIFIED="1426313300531" TEXT="点击劫持"><node CREATED="1426313300531" ID="7mailau9lepo3gmdkvaruf7i60" MODIFIED="1426313300531" TEXT="手段"><node CREATED="1426313300531" ID="235hslv39f4beusietor2l2df0" MODIFIED="1426313300531" TEXT="使用CSS的opacity属性，设置目标框架透明"/></node><node CREATED="1426313300532" ID="7uhnvt5upjqk3gvm87h866qeo8" MODIFIED="1426313300532" TEXT="解决"><node CREATED="1426313300532" ID="277eocunckr6b03k0ltfaj5dbk" MODIFIED="1426313300532" TEXT="渲染器增加自启发机制，禁止在部分遮挡或显示时间不够长的跨域框架里进行事件传递"><node CREATED="1426313300532" ID="11g4bjtdaf5elveeeu0hm65vjt" MODIFIED="1426313300532" TEXT="没有得到推广"/></node><node CREATED="1426313300532" ID="5gj7bi1jqgplemqom4lb5sq1if" MODIFIED="1426313300532" TEXT="增加HTTP响应头X-Frame-Options"><node CREATED="1426313300532" ID="6hotf8c5g9mlt14ulpebv3i0ck" MODIFIED="1426313300532" TEXT="对解决漏洞的意义不大"><node CREATED="1426313300532" ID="74fha8roeu5769vmb1us7jf36s" MODIFIED="1426313300532" TEXT="大部分站点不会很快跟进"/><node CREATED="1426313300532" ID="3d28cg9lbdefh09uj2socq87m4" MODIFIED="1426313300532" TEXT="对既允许第三方站点嵌入但同时希望保持自身UI完整的站点没用"/></node></node></node></node><node CREATED="1426313300532" ID="487k4cblpqk84480ti0d5mvqa6" MODIFIED="1426313300532" TEXT="在简单的点击之外"><node CREATED="1426313300532" ID="0he13u1vpf82au4dmcrh7t5cbt" MODIFIED="1426313300532" TEXT="拖放动作"><node CREATED="1426313300532" ID="0bu3usraec9a212kcts00jpes9" MODIFIED="1426313300532" TEXT="Webkit禁用跨域拖放"/></node><node CREATED="1426313300532" ID="41kufjqcfj2jt4isjb9lkf6lol" MODIFIED="1426313300532" TEXT="按键重定向"><node CREATED="1426313300532" ID="7k95b7bc1oinndmjjjk26kpvg9" MODIFIED="1426313300532" TEXT="方法"><node CREATED="1426313300532" ID="1aa9v09pvttb7scujms6ldhhf1" MODIFIED="1426313300532" TEXT="通过JS的onkeydown获得按键的代码值对特定的按键跨域重定向"/></node><node CREATED="1426313300532" ID="26osmqql7eqtb6e9ldk0ja0iq4" MODIFIED="1426313300532" TEXT="解决"><node CREATED="1426313300532" ID="1010e6vvg6mg0ujnemcl294htp" MODIFIED="1426313300532" TEXT="对一次按键期间禁止对页面元素焦点的变更"><node CREATED="1426313300532" ID="0qsq1gq7719su0s42kfqrat9k1" MODIFIED="1426313300532" TEXT="问题"><node CREATED="1426313300532" ID="0s4mctuo5p0hrplequkvd3ulvh" MODIFIED="1426313300532" TEXT="基于推测的聚焦切换"/></node></node></node></node></node></node></node><node CREATED="1426313300532" ID="6f5pf5d7kd1ruehpqp456br30u" MODIFIED="1426313300532" POSITION="right" TEXT="跨域内容包含"><node CREATED="1426313300532" ID="2q3iefgkohtcmm5lh70693ih0j" MODIFIED="1426313300532" TEXT="问题"><node CREATED="1426313300532" ID="7sddk77qe8l3ffdg43fdp2jqme" MODIFIED="1426313300532" TEXT="请求某个子资源时，服务器需要同时发送与这个子资源的源相关的全局身份信息吗？"/><node CREATED="1426313300532" ID="17d5f99rqfjcpuk4ser5sefa18" MODIFIED="1426313300532" TEXT="相关的解析器在设计上是否应尽量降低文件类型误判的风险吗？"/><node CREATED="1426313300532" ID="023t86j5kpi6ll9p6oa5p2gbla" MODIFIED="1426313300532" TEXT="向子资源发出请求的主页面是否不能对取回的数据内容进行主动监测呢？"/></node><node CREATED="1426313300532" ID="7738pside1cdoa3dgsc7q7vuls" MODIFIED="1426313300532" TEXT="安全隐患"><node CREATED="1426313300532" ID="5d4q4u74ht68ff8pkdcukd8dt1" MODIFIED="1426313300532" TEXT="JS的onerror"/><node CREATED="1426313300532" ID="1usg9s4plj656j4tgoveoabv1a" MODIFIED="1426313300532" TEXT="CSS对解析器出错的容忍度过高"><node CREATED="1426313300532" ID="0jde82s0s7aof8oju7fuaved0q" MODIFIED="1426313300532" TEXT="解决"><node CREATED="1426313300532" ID="2jdf6b1dtu4m9bfhu9lo64i6fa" MODIFIED="1426313300532" TEXT="对文件头的内容并非有效CSS规则的跨域样式表，或响应头为不兼容的Content-TYpe拒绝解析"/></node></node><node CREATED="1426313300532" ID="70j6ufngsn0i8abu3e51t16glm" MODIFIED="1426313300532" TEXT="canvas"><node CREATED="1426313300532" ID="5hjboeur0a7mqqmr4djhlm6fam" MODIFIED="1426313300533" TEXT="问题"><node CREATED="1426313300533" ID="6j9k30c6b5vvc3dplg8qplhlme" MODIFIED="1426313300533" TEXT="加载跨域图片"/></node><node CREATED="1426313300533" ID="07t589bh0f744omv8nn6tuhu9f" MODIFIED="1426313300533" TEXT="解决"><node CREATED="1426313300533" ID="1sslkdbru9lbv5kqn5c2q369vl" MODIFIED="1426313300533" TEXT="画布加载过跨域图片后不能读取只能写入"/></node></node></node><node CREATED="1426313300533" ID="1hnhhkaarhufl4mtn9js7s78ps" MODIFIED="1426313300533" TEXT="关于跨源子资源的问题"><node CREATED="1426313300533" ID="3t33a2smjrcjk6cuvh7r6sbfpj" MODIFIED="1426313300533" TEXT="问题资源"><node CREATED="1426313300533" ID="5cg98u4ma2028nkhk17edi8cln" MODIFIED="1426313300533" TEXT="远程字体"/><node CREATED="1426313300533" ID="7bkit5l09c8hngesbb7ao5vgdu" MODIFIED="1426313300533" TEXT="有权访问所在页面的插件小程序"/></node><node CREATED="1426313300533" ID="7qbrla8j5nkd3lqgm426vvrv1m" MODIFIED="1426313300533" TEXT="检查在HTTPS页面里加载HTTP资源的情况"><node CREATED="1426313300533" ID="2rn6qbf2fdl3jept2qdb3blstu" MODIFIED="1426313300533" TEXT="IE默认拦截大部分混合内容"/><node CREATED="1426313300533" ID="7pl7bknsb6vittm20frhgv109d" MODIFIED="1426313300533" TEXT="所有浏览器都在检查&lt;embed&gt;、&lt;object&gt;、&lt;applet&gt;标签的混合内容时没有统一的处理"/><node CREATED="1426313300533" ID="5vuaadj17eg1qfqfe0g9bvgh7q" MODIFIED="1426313300533" TEXT="在信任程度不同的域加载子资源没法检查"/></node></node></node><node CREATED="1426313300533" ID="52v8gm7s4735jthmdiblhjh6co" MODIFIED="1426313300533" POSITION="right" TEXT="与隐私相关的副作用"><node CREATED="1426313300533" ID="4nmje71bfu315raiii6hgos76k" MODIFIED="1426313300533" TEXT="副作用"><node CREATED="1426313300533" ID="676tqfoo9qthd06arosj300fc7" MODIFIED="1426313300533" TEXT="收集用户与其他无关网站的交互信息"/></node><node CREATED="1426313300533" ID="1r8lad1suqbnkkdj2pgjmdaipt" MODIFIED="1426313300533" TEXT="例子"><node CREATED="1426313300533" ID="123fmek3gqqdc183grs4hu972k" MODIFIED="1426313300533" TEXT="通过onload测量加载某个页面的时间，判断是都已访问过"/><node CREATED="1426313300533" ID="33gmut5fujvuvie75e6hrbrk73" MODIFIED="1426313300533" TEXT="对&lt;img&gt;标签使用onload或onerror，测试是否可以加载第三方站点一个需要授权的照片，判断用户是否登录过该站点"/><node CREATED="1426313300533" ID="6stinqios4j52lu5osu2krfk2g" MODIFIED="1426313300533" TEXT="在一个隐藏框架里加载无关的Web应用，检测此页面包含的子框架数量和名称、全局变量集合，判断用户登录情况"/><node CREATED="1426313300533" ID="4k0d46p2rctmhbahm27vm067km" MODIFIED="1426313300533" TEXT="CSS的API（getComputedStype、IE的currentStyle）"><node CREATED="1426313300533" ID="66v63ulri01b6nbf74r0pdt6ss" MODIFIED="1426313300533" TEXT="检查URL外观是否变化，得到用户在线访问习惯"/></node></node></node><node CREATED="1426313300533" ID="2vi22r5p8a8msrrr7kvmpa3l1m" MODIFIED="1426313300533" POSITION="left" TEXT="其他的同源漏洞和应用"><node CREATED="1426313300533" ID="43vevqvrso94m035544djeq773" MODIFIED="1426313300533" TEXT="例子"><node CREATED="1426313300533" ID="1tpr4vm5ng667n7hmbrphce38i" MODIFIED="1426313300533" TEXT="多个版本的IE中，能修改无关窗口的window.opener或window.name"/><node CREATED="1426313300533" ID="7b48nafkplj5hh2pvar1ev9vl0" MODIFIED="1426313300533" TEXT="Firefox里对跨域设置location.hash没有限制"/></node></node><node CREATED="1426313300533" ID="65m4u0s0v0uj7sb0k59hh3ij9d" MODIFIED="1426313300533" POSITION="left" TEXT="安全工程速查表"><node CREATED="1426313300533" ID="6kg13304u0sdvlfqegds5balmu" MODIFIED="1426313300533" TEXT="所有网站都适用的安全准则"><node CREATED="1426313300533" ID="4mq8do9l4se6hibfgcm3ph6g63" MODIFIED="1426313300533" TEXT="所有内容都应该使用X-Frame-Options: sameorigin响应头"/><node CREATED="1426313300533" ID="3po11rfu7qiaua3lis7cvcr3h0" MODIFIED="1426313300533" TEXT="尽量不使用JS的破除框架代码来防止页面在框架里被引用"/><node CREATED="1426313300533" ID="35kmeb363l45sd2q5tm47mu7jr" MODIFIED="1426313300533" TEXT="在返回不应被跨域使用的用户相关敏感数据时，使用明确设定的格式，使用正确的Content-Type"/></node><node CREATED="1426313300533" ID="334npuaruj3mi1su0dtnf7sg1k" MODIFIED="1426313300533" TEXT="当包含跨域资源时"><node CREATED="1426313300533" ID="4036p2g0gqrevjjrgk95k3fbh0" MODIFIED="1426313300533" TEXT="宁可做一个本地备份再使用"/><node CREATED="1426313300533" ID="5f8454mkjepiie2htib09km714" MODIFIED="1426313300533" TEXT="在HTTPS站点里，所有的子资源也要使用HTTPS协议"/></node><node CREATED="1426313300533" ID="2ch8louq7om6iiaam59h2omduj" MODIFIED="1426313300533" TEXT="当处理JS里的跨域通信时"><node CREATED="1426313300533" ID="7ca0fj0smbgncmjc28t4kq67fv" MODIFIED="1426313300533" TEXT="参加第9章速查表"/><node CREATED="1426313300533" ID="6lqr4j4gl6v3pu8oj47kngo3cg" MODIFIED="1426313300533" TEXT="不要指望站点的子框架是一成不变的"/></node></node></node></map>